<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="/css/maininterface/index.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="/js/CMS6_2announcement/main_announcement.js"></script>	
	<title>Document</title>
</head>

<body>
	<div class="container" >
		<div class="row" id="titleImg">
			<h1 id="titleText">i上班員工管理系統</h1>
		</div> 
	</div>
	<div class="container " >
		<div class="row justify-content-around">
			<div class="col-3 textDiv">
				<p id="announcement"> 
                    <div style="color: darksalmon;position: relative;text-align: center;"><b>公告</b></div>
                    <ul id="mainAnnouncement">
                        <!-- <li id="notice"></li> -->
                    </ul>
				</P>
			</div>

			<div class="col-4" id="login">
				<div class="row">
					<p>登入系統</p>
					<hr>
				</div>
				<div class="row" id="labelEmp">
					<div class="col-3">
						<label class="label_input">使用者名稱</label>
					</div>
					<div class="col-6">
						<input type="text" id="userEmp"  required />
					</div>
				</div>
				<div class="row mt-2" id="labelPsw">
					<div class="col-3">
						<label class="label_input">密碼</label>
					</div>
					<div class="col-6">
						<input type="password" id="userPsw"  required />
					</div>
				</div>

				<div id="login_control" class="row mt-3">
					<div id="login_control" >
                    <button id="btn_login">登入</button>
					<a id="forget_pwd" href="還沒寫">忘記密碼？</a>
				</div>
			</div>
		</div>

	</div>




	

</div>

    <!-- 背景泡泡 -->
    <ul class="bubble">
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
    </ul>


	<script>
        $("#btn_login").click(function(){
            $(this).html(`<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        <span >Loading...</span>`);
            login();           
        });

		function login() {
			var inputData = JSON.stringify([{
				empId: $("#userEmp").val(),
				passwd: $("#userPsw").val()
			}]);

			$.ajax({
				type: "post",
				url: "http://localhost:8080/loginAction",
				data: inputData,
				contentType: 'application/json',
				success: function (data) {
					console.log(data);
					if(data.state == "100"){
					document.cookie = `cookie1= ${data.token}`;  
					window.location.href="/CMS_0interface.html";
					}else if(data.state == "101"){
                        $("#btn_login").html('登入');
					    alert("查無帳號");
					}else if(data.state == "102"){
                        $("#btn_login").html('登入');
					    alert("密碼錯誤");
					 }
				}
			});
		}



	</script>


</body>

</html>